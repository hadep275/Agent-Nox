(()=>{"use strict";var t,e,n,a={7072:(t,e,n)=>{var a=n(5085),s=n(354),r=n.n(s);class o{constructor(){this.vscode=acquireVsCodeApi(),window.vscode=this.vscode,this.currentFilter="lifetime",this.analyticsData=null,this.initialize()}initialize(){this.setupUI(),this.setupEventListeners(),this.requestAnalyticsData()}setupUI(){this.elements={filterSelect:document.getElementById("filterSelect"),exportBtn:document.getElementById("exportBtn"),exportMenu:document.getElementById("exportMenu"),customDateRange:document.getElementById("customDateRange"),customDateStart:document.getElementById("customDateStart"),customDateEnd:document.getElementById("customDateEnd"),applyCustomBtn:document.getElementById("applyCustomBtn"),summaryCards:document.getElementById("summaryCards"),chartsGrid:document.getElementById("chartsGrid"),tableContainer:document.getElementById("tableContainer"),loadingState:document.getElementById("loadingState"),costBreakdownChart:document.getElementById("costBreakdownChart"),costTrendsChart:document.getElementById("costTrendsChart"),messagesPerDayChart:document.getElementById("messagesPerDayChart")},this.charts={}}setupEventListeners(){this.elements.filterSelect?.addEventListener("change",t=>{this.currentFilter=t.target.value,"custom"===t.target.value?this.elements.customDateRange&&(this.elements.customDateRange.style.display="block"):(this.elements.customDateRange&&(this.elements.customDateRange.style.display="none"),this.requestAnalyticsData())}),this.elements.applyCustomBtn?.addEventListener("click",()=>{const t=this.elements.customDateStart?.value,e=this.elements.customDateEnd?.value;t&&e&&this.requestAnalyticsData("custom",{start:t,end:e})}),this.elements.exportBtn?.addEventListener("click",()=>{this.toggleExportMenu()}),document.querySelectorAll(".export-menu-item").forEach(t=>{t.addEventListener("click",t=>{const e=t.target.dataset.format;this.exportData(e),this.closeExportMenu()})}),document.addEventListener("click",t=>{t.target.closest(".export-dropdown-container")||"block"!==this.elements.exportMenu?.style.display||this.closeExportMenu()}),window.addEventListener("message",t=>{const e=t.data;"analyticsData"===e.type&&(this.analyticsData=e.data,this.renderDashboard())})}requestAnalyticsData(t="lifetime",e=null){this.showLoading(!0),this.vscode.postMessage({type:"getAnalyticsData",filterType:t||this.currentFilter,customDates:e})}renderDashboard(){this.showLoading(!1),this.analyticsData&&(this.renderSummaryCards(),this.renderCharts(),this.renderTables())}renderSummaryCards(){const{stats:t}=this.analyticsData,e=`\n      <div class="summary-card">\n        <div class="card-label">Total Messages</div>\n        <div class="card-value">${this.analyticsData.messageCount}</div>\n      </div>\n      <div class="summary-card">\n        <div class="card-label">Total Cost</div>\n        <div class="card-value">$${t.totalCost.toFixed(4)}</div>\n        <div class="card-subtext">Avg: $${t.averageCostPerMessage}/msg</div>\n      </div>\n      <div class="summary-card">\n        <div class="card-label">Total Tokens</div>\n        <div class="card-value">${t.totalTokens.toLocaleString()}</div>\n        <div class="card-subtext">Avg: ${t.averageTokensPerMessage}/msg</div>\n      </div>\n      <div class="summary-card">\n        <div class="card-label">Cost per Token</div>\n        <div class="card-value">$${t.costPerToken}</div>\n      </div>\n    `;this.elements.summaryCards.innerHTML=e}renderCharts(){if(!this.analyticsData)return;const t={blue:"#4c9aff",purple:"#7c3aed",green:"#10b981",pink:"#f472b6",cyan:"#06b6d4",orange:"#f59e0b"};Object.values(this.charts).forEach(t=>t.destroy()),this.charts={},setTimeout(()=>{this.renderCostBreakdownChart(t),this.renderCostTrendsChart(t),this.renderMessagesPerDayChart(t)},100)}renderTables(){const{providerBreakdown:t,dailyBreakdown:e}=this.analyticsData;let n='\n      <div class="table-container">\n        <div class="table-title">Provider Breakdown</div>\n        <table>\n          <thead>\n            <tr>\n              <th>Provider</th>\n              <th>Cost</th>\n              <th>Tokens</th>\n              <th>Messages</th>\n              <th>Avg Cost/Msg</th>\n              <th>Cost/Token</th>\n              <th>%</th>\n            </tr>\n          </thead>\n          <tbody>\n    ';t.forEach(t=>{n+=`\n        <tr>\n          <td>${t.provider}</td>\n          <td>$${t.totalCost.toFixed(4)}</td>\n          <td>${t.totalTokens.toLocaleString()}</td>\n          <td>${t.messageCount}</td>\n          <td>$${t.averageCostPerMessage}</td>\n          <td>$${t.costPerToken}</td>\n          <td>${t.percentage}%</td>\n        </tr>\n      `}),n+="\n          </tbody>\n        </table>\n      </div>\n    ";let a='\n      <div class="table-container">\n        <div class="table-title">Daily Breakdown</div>\n        <table>\n          <thead>\n            <tr>\n              <th>Date</th>\n              <th>Messages</th>\n              <th>Cost</th>\n              <th>Tokens</th>\n            </tr>\n          </thead>\n          <tbody>\n    ';e.forEach(t=>{a+=`\n        <tr>\n          <td>${t.date}</td>\n          <td>${t.messageCount}</td>\n          <td>$${t.totalCost.toFixed(4)}</td>\n          <td>${t.totalTokens.toLocaleString()}</td>\n        </tr>\n      `}),a+="\n          </tbody>\n        </table>\n      </div>\n    ",this.elements.tableContainer.innerHTML=n+a}renderCharts(){if(!this.analyticsData)return;const t={blue:"#4c9aff",purple:"#7c3aed",green:"#10b981",pink:"#f472b6",cyan:"#06b6d4",orange:"#f59e0b"};Object.values(this.charts).forEach(t=>t.destroy()),this.charts={},this.renderCostBreakdownChart(t),this.renderCostTrendsChart(t),this.renderMessagesPerDayChart(t)}renderCostBreakdownChart(t){const e=this.elements.costBreakdownChart?.getContext("2d");if(!e)return;const n=this.analyticsData.providerBreakdown;if(!n||0===n.length)return;const a=[t.blue,t.purple,t.green,t.pink,t.cyan],s=n.map(t=>"string"==typeof t.totalCost?parseFloat(t.totalCost.replace("$","")):t.totalCost);this.charts.costBreakdown=new Chart(e,{type:"doughnut",data:{labels:n.map(t=>t.provider),datasets:[{data:s,backgroundColor:a.slice(0,n.length),borderColor:"#1e1e1e",borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{position:"bottom",labels:{color:"#e0e0e0",font:{size:12},padding:15}},tooltip:{callbacks:{label:t=>{const e=t.parsed,n=(e/t.dataset.data.reduce((t,e)=>t+e,0)*100).toFixed(1);return`$${e.toFixed(4)} (${n}%)`}}}}}})}renderCostTrendsChart(t){const e=this.elements.costTrendsChart?.getContext("2d");if(!e)return;const n=this.analyticsData.dailyBreakdown;if(!n||0===n.length)return;const a=n.map(t=>"string"==typeof t.totalCost?parseFloat(t.totalCost.replace("$","")):t.totalCost);this.charts.costTrends=new Chart(e,{type:"line",data:{labels:n.map(t=>t.date),datasets:[{label:"Daily Cost",data:a,borderColor:t.blue,backgroundColor:`${t.blue}20`,borderWidth:2,fill:!0,tension:.4,pointRadius:4,pointBackgroundColor:t.blue,pointBorderColor:"#1e1e1e",pointBorderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{labels:{color:"#e0e0e0",font:{size:12}}},tooltip:{callbacks:{label:t=>`$${t.parsed.y.toFixed(4)}`}}},scales:{y:{beginAtZero:!0,ticks:{color:"#a0a0a0"},grid:{color:"#333333"}},x:{ticks:{color:"#a0a0a0"},grid:{color:"#333333"}}}}})}renderMessagesPerDayChart(t){const e=this.elements.messagesPerDayChart?.getContext("2d");if(!e)return;const n=this.analyticsData.dailyBreakdown;if(!n||0===n.length)return;const a=n.map(t=>"string"==typeof t.messageCount?parseInt(t.messageCount):t.messageCount);this.charts.messagesPerDay=new Chart(e,{type:"bar",data:{labels:n.map(t=>t.date),datasets:[{label:"Messages",data:a,backgroundColor:t.purple,borderColor:"#1e1e1e",borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!0,plugins:{legend:{labels:{color:"#e0e0e0",font:{size:12}}}},scales:{y:{beginAtZero:!0,ticks:{color:"#a0a0a0"},grid:{color:"#333333"}},x:{ticks:{color:"#a0a0a0"},grid:{color:"#333333"}}}}})}toggleExportMenu(){const t=this.elements.exportMenu;"none"===t.style.display||""===t.style.display?t.style.display="block":t.style.display="none"}closeExportMenu(){this.elements.exportMenu&&(this.elements.exportMenu.style.display="none")}exportData(t="json"){if(!this.analyticsData)return;const e={exportDate:(new Date).toISOString(),filterType:this.currentFilter,dateRange:this.analyticsData.dateRange,stats:this.analyticsData.stats,providerBreakdown:this.analyticsData.providerBreakdown,dailyBreakdown:this.analyticsData.dailyBreakdown},n=(new Date).toISOString().split("T")[0];"json"===t?this.exportJSON(e,n):"csv"===t?this.exportCSV(e,n):"pdf"===t&&this.exportPDF(e,n)}exportJSON(t,e){const n=JSON.stringify(t,null,2),a=new Blob([n],{type:"application/json"}),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=`nox-analytics-${e}.json`,r.click(),URL.revokeObjectURL(s)}exportCSV(t,e){let n="Nox Analytics Export\n";n+=`Export Date: ${t.exportDate}\n`,n+=`Filter Type: ${t.filterType}\n\n`,n+="STATISTICS\n",n+="Metric,Value\n",n+=`Total Messages,${t.stats.totalMessages}\n`,n+=`Total Cost,$${t.stats.totalCost.toFixed(4)}\n`,n+=`Total Tokens,${t.stats.totalTokens}\n`,n+=`Avg Cost/Message,$${t.stats.averageCostPerMessage}\n`,n+=`Avg Tokens/Message,${t.stats.averageTokensPerMessage}\n`,n+=`Cost per Token,$${t.stats.costPerToken}\n\n`,n+="PROVIDER BREAKDOWN\n",n+="Provider,Cost,Tokens,Messages,Avg Cost/Msg,Cost/Token,Percentage\n",t.providerBreakdown.forEach(t=>{n+=`${t.provider},$${t.totalCost.toFixed(4)},${t.totalTokens},${t.messageCount},$${t.averageCostPerMessage},$${t.costPerToken},${t.percentage}%\n`}),n+="\n",n+="DAILY BREAKDOWN\n",n+="Date,Cost,Tokens,Messages\n",t.dailyBreakdown.forEach(t=>{n+=`${t.date},$${t.totalCost.toFixed(4)},${t.totalTokens},${t.messageCount}\n`});const a=new Blob([n],{type:"text/csv"}),s=URL.createObjectURL(a),r=document.createElement("a");r.href=s,r.download=`nox-analytics-${e}.csv`,r.click(),URL.revokeObjectURL(s)}async exportPDF(t,e){try{const n=this.elements.exportBtn.textContent;this.elements.exportBtn.textContent="📑 Generating PDF...",this.elements.exportBtn.disabled=!0;const s=document.createElement("div");s.style.position="absolute",s.style.left="-9999px",s.style.width="800px",s.style.backgroundColor="#0f172a",s.style.color="#e2e8f0",s.style.padding="40px",s.style.fontFamily="Arial, sans-serif",s.innerHTML=`\n        <div style="text-align: center; margin-bottom: 40px;">\n          <h1 style="margin: 0; font-size: 32px; color: #4c9aff;">🦊 Nox Analytics Report</h1>\n          <p style="margin: 10px 0 0 0; color: #94a3b8; font-size: 14px;">Generated on ${(new Date).toLocaleString()}</p>\n        </div>\n\n        <div style="margin-bottom: 30px; padding: 20px; background: rgba(76, 154, 255, 0.1); border-radius: 8px;">\n          <h2 style="margin: 0 0 15px 0; font-size: 18px; color: #4c9aff;">Report Summary</h2>\n          <p style="margin: 5px 0; font-size: 14px;"><strong>Filter Type:</strong> ${t.filterType}</p>\n          <p style="margin: 5px 0; font-size: 14px;"><strong>Date Range:</strong> ${new Date(t.dateRange.startDate).toLocaleDateString()} to ${new Date(t.dateRange.endDate).toLocaleDateString()}</p>\n        </div>\n\n        <div style="margin-bottom: 30px;">\n          <h2 style="margin: 0 0 15px 0; font-size: 18px; color: #4c9aff;">Key Metrics</h2>\n          <table style="width: 100%; border-collapse: collapse; font-size: 14px;">\n            <tr style="background: rgba(76, 154, 255, 0.1);">\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3);"><strong>Total Messages</strong></td>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;"><strong>${t.stats.totalMessages}</strong></td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3);">Total Cost</td>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">$${t.stats.totalCost.toFixed(4)}</td>\n            </tr>\n            <tr style="background: rgba(76, 154, 255, 0.05);">\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3);">Total Tokens</td>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">${t.stats.totalTokens}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3);">Avg Cost/Message</td>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">$${t.stats.averageCostPerMessage}</td>\n            </tr>\n            <tr style="background: rgba(76, 154, 255, 0.05);">\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3);">Avg Tokens/Message</td>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">${t.stats.averageTokensPerMessage}</td>\n            </tr>\n            <tr>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3);">Cost per Token</td>\n              <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">$${t.stats.costPerToken}</td>\n            </tr>\n          </table>\n        </div>\n\n        <div style="margin-bottom: 30px;">\n          <h2 style="margin: 0 0 15px 0; font-size: 18px; color: #4c9aff;">Provider Breakdown</h2>\n          <table style="width: 100%; border-collapse: collapse; font-size: 12px;">\n            <tr style="background: rgba(76, 154, 255, 0.1);">\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: left;"><strong>Provider</strong></th>\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;"><strong>Cost</strong></th>\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;"><strong>Tokens</strong></th>\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;"><strong>Messages</strong></th>\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;"><strong>%</strong></th>\n            </tr>\n            ${t.providerBreakdown.map((t,e)=>`\n              <tr style="background: ${e%2==0?"rgba(76, 154, 255, 0.05)":"transparent"};">\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3);">${t.provider}</td>\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">$${t.totalCost.toFixed(4)}</td>\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">${t.totalTokens}</td>\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">${t.messageCount}</td>\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">${t.percentage}%</td>\n              </tr>\n            `).join("")}\n          </table>\n        </div>\n\n        <div style="margin-bottom: 30px;">\n          <h2 style="margin: 0 0 15px 0; font-size: 18px; color: #4c9aff;">Daily Breakdown</h2>\n          <table style="width: 100%; border-collapse: collapse; font-size: 12px;">\n            <tr style="background: rgba(76, 154, 255, 0.1);">\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: left;"><strong>Date</strong></th>\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;"><strong>Cost</strong></th>\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;"><strong>Tokens</strong></th>\n              <th style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;"><strong>Messages</strong></th>\n            </tr>\n            ${t.dailyBreakdown.map((t,e)=>`\n              <tr style="background: ${e%2==0?"rgba(76, 154, 255, 0.05)":"transparent"};">\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3);">${t.date}</td>\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">$${t.totalCost.toFixed(4)}</td>\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">${t.totalTokens}</td>\n                <td style="padding: 10px; border: 1px solid rgba(76, 154, 255, 0.3); text-align: right;">${t.messageCount}</td>\n              </tr>\n            `).join("")}\n          </table>\n        </div>\n\n        <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid rgba(76, 154, 255, 0.3); text-align: center; color: #94a3b8; font-size: 12px;">\n          <p style="margin: 0;">Generated by Nox Analytics Dashboard</p>\n          <p style="margin: 5px 0 0 0;">© 2025 Nox - Your AI Coding Fox 🦊</p>\n        </div>\n      `,document.body.appendChild(s);const o=await r()(s,{backgroundColor:"#0f172a",scale:2,logging:!1}),d=new a.uE({orientation:"portrait",unit:"mm",format:"a4"}),i=o.toDataURL("image/png"),l=210,g=297;let c=o.height*(l/o.width),p=0;for(d.addImage(i,"PNG",0,p,l,c),c-=g;c>=0;)p=c-o.height*(l/o.width),d.addPage(),d.addImage(i,"PNG",0,p,l,c),c-=g;d.save(`nox-analytics-${e}.pdf`),document.body.removeChild(s),this.elements.exportBtn.textContent=n,this.elements.exportBtn.disabled=!1}catch(t){console.error("PDF export error:",t),alert("Failed to generate PDF. Please try again."),this.elements.exportBtn.textContent=originalText,this.elements.exportBtn.disabled=!1}}showLoading(t){this.elements.loadingState&&(this.elements.loadingState.style.display=t?"flex":"none")}}document.addEventListener("DOMContentLoaded",()=>{new o})}},s={};function r(t){var e=s[t];if(void 0!==e)return e.exports;var n=s[t]={exports:{}};return a[t].call(n.exports,n,n.exports,r),n.exports}r.m=a,t=[],r.O=(e,n,a,s)=>{if(!n){var o=1/0;for(g=0;g<t.length;g++){for(var[n,a,s]=t[g],d=!0,i=0;i<n.length;i++)(!1&s||o>=s)&&Object.keys(r.O).every(t=>r.O[t](n[i]))?n.splice(i--,1):(d=!1,s<o&&(o=s));if(d){t.splice(g--,1);var l=a();void 0!==l&&(e=l)}}return e}s=s||0;for(var g=t.length;g>0&&t[g-1][2]>s;g--)t[g]=t[g-1];t[g]=[n,a,s]},r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},n=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,r.t=function(t,a){if(1&a&&(t=this(t)),8&a)return t;if("object"==typeof t&&t){if(4&a&&t.__esModule)return t;if(16&a&&"function"==typeof t.then)return t}var s=Object.create(null);r.r(s);var o={};e=e||[null,n({}),n([]),n(n)];for(var d=2&a&&t;("object"==typeof d||"function"==typeof d)&&!~e.indexOf(d);d=n(d))Object.getOwnPropertyNames(d).forEach(e=>o[e]=()=>t[e]);return o.default=()=>t,r.d(s,o),s},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.e=()=>Promise.resolve(),r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t={792:0};r.O.j=e=>0===t[e];var e=(e,n)=>{var a,s,[o,d,i]=n,l=0;if(o.some(e=>0!==t[e])){for(a in d)r.o(d,a)&&(r.m[a]=d[a]);if(i)var g=i(r)}for(e&&e(n);l<o.length;l++)s=o[l],r.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return r.O(g)},n=self.webpackChunknox_vscode=self.webpackChunknox_vscode||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var o=r.O(void 0,[418],()=>r(7072));o=r.O(o)})();
//# sourceMappingURL=dashboardPanel.js.map